import {EventEmitter, NativeModulesProxy, Subscription} from 'expo-modules-core'

import ExpoAudioStreamModule from './ExpoAudioStreamModule'

export async function playStreamFromURL(
	url: string,
	headers: Record<string, string>,
	body: string
) {
	return await ExpoAudioStreamModule.playStreamFromURL(url, headers, body)
}

export async function stopPlayback() {
	return await ExpoAudioStreamModule.stopPlayback()
}

const emitter = new EventEmitter(
	ExpoAudioStreamModule ?? NativeModulesProxy.ExpoAudioStream
)

export function addStatusUpdateListener(
	listener: (event: any) => void
): Subscription {
	return emitter.addListener('onStatusUpdate', listener)
}
